select nt.id as nodeid, et.* from Network nt join NetworkEvent et on nt.id=et.dstid where nt.srcip='192.168.1.131/32' and  nt.dstip='192.168.1.128/32' and  nt.hostid='1' and et.id='29704'
startNode: 664 edgeTime:1724732319377872104Postgres - backward executed in 3 s.
jg generated by the backtrack has: 167 vertices and 6399 edges.
after CPR: 167 vertices and 494 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
PageRankIteration called!!!!!!!!!!!!!!!!!!
PageRankIteration - After 1725 times iteration, the reputation of each vertex is stable
PageRankIteration execution time is: 0.224
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 399(File) signature: 399: /root/.ssh/id_rsa reputation: 0.4981157502840937
 @@@@@ Top 2: id: 664(Network) signature: 664: 192.168.1.131/32:33110->192.168.1.128/32:22 reputation: 1.0
 @@@@@ Top 3: id: 397(File) signature: 397: /etc/ssh/ssh_config reputation: 0.46517656231117516
 @@@@@ Top 4: id: 655(Network) signature: 655: 192.168.1.131/32:49700->192.168.1.123/32:9001 reputation: 0.503350752842523
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=399
Postgres - Forward query executed 0 s.
- internalJg vertices:35, edges:5392
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=664 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=664 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=664
Postgres - Forward query executed 0 s.
- internalJg vertices:1, edges:0
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=397
Postgres - Forward query executed 0 s.
- internalJg vertices:35, edges:5381
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=655 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=655 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=655
Postgres - Forward query executed 0 s.
- internalJg vertices:9, edges:120
createIntersectJg-jg1: 167 vertices and 494 edges. jg2(union forward graphs generated by entry nodes): 36 vertices and 5406 edges.
jgIntersect has: 33 vertices and 84 edges.
1111111111111111111 finaljg has: 33 vertices and 84 edges.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/var/stage2",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 2 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732531452003131) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/var/stage2' and  nt.hostid='2' and et.optype='write'
startNode: 5616 edgeTime:1724732375032502907Postgres - backward executed in 8 s.
jg generated by the backtrack has: 678 vertices and 22385 edges.
after CPR: 678 vertices and 2441 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
PageRankIteration called!!!!!!!!!!!!!!!!!!
PageRankIteration - After 2400 times iteration, the reputation of each vertex is stable
PageRankIteration execution time is: 0.681
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 5331(File) signature: 5331: /etc/ssl/certs/ca-certificates.crt reputation: 0.926565443939088
 @@@@@ Top 2: id: 5325(Network) signature: 5325: 127.0.0.1/32:35353->127.0.0.53/32:53 reputation: 0.926565443939088
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5331 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5331 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5331
Postgres - Forward query executed 0 s.
- internalJg vertices:13, edges:1192
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5325 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5325 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5325
Postgres - Forward query executed 0 s.
- internalJg vertices:13, edges:1193
createIntersectJg-jg1: 678 vertices and 2441 edges. jg2(union forward graphs generated by entry nodes): 14 vertices and 1197 edges.
jgIntersect has: 14 vertices and 25 edges.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/tmp/vpnfilter",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 12 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732531452003131) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/tmp/vpnfilter' and  nt.hostid='2' and et.optype='write'
startNode: 5315 edgeTime:1724732373470948490Postgres - backward executed in 5 s.
jg generated by the backtrack has: 314 vertices and 22151 edges.
after CPR: 314 vertices and 1962 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
PageRankIteration called!!!!!!!!!!!!!!!!!!
PageRankIteration - After 2148 times iteration, the reputation of each vertex is stable
PageRankIteration execution time is: 0.357
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 3226(File) signature: 3226: /etc/wgetrc reputation: 0.6399799632229082
 @@@@@ Top 2: id: 5314(Network) signature: 5314: 192.168.1.128/32:53534->192.168.1.123/32:9001 reputation: 0.9556930269043352
 @@@@@ Top 3: id: 1968(File) signature: 1968: /etc/localtime reputation: 0.42503349398001067
 @@@@@ Top 4: id: 3230(Network) signature: 3230: 192.168.1.128/32:48216->162.125.3.18/32:443 reputation: 0.4899611038761957
 @@@@@ Top 5: id: 1754(File) signature: 1754: /etc/hosts reputation: 0.4174009631990443
 @@@@@ Top 6: id: 3236(Network) signature: 3236: 192.168.1.128/32:42050->162.125.3.15/32:443 reputation: 0.4899611038761957
 @@@@@ Top 7: id: 3168(File) signature: 3168: /etc/resolv.conf reputation: 0.4147592562713898
 @@@@@ Top 8: id: 5028(Network) signature: 5028: 192.168.1.131/32:55898->192.168.1.128/32:22 reputation: 0.3624897867940652
 @@@@@ Top 9: id: 3167(File) signature: 3167: /etc/host.conf reputation: 0.41475923623756644
 @@@@@ Top 10: id: 5175(Network) signature: 5175: 192.168.1.128/32:22->192.168.1.131/32:55898 reputation: 0.3624897867940651
 @@@@@ Top 11: id: 1923(File) signature: 1923: /etc/gai.conf reputation: 0.39770927553601254
 @@@@@ Top 12: id: 4491(Network) signature: 4491: 192.168.1.131/32:33110->192.168.1.128/32:22 reputation: 0.3126556930601121
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3226 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3226 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3226
Postgres - Forward query executed 0 s.
- internalJg vertices:621, edges:22737
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5314 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5314 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5314
Postgres - Forward query executed 0 s.
- internalJg vertices:21, edges:2840
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1968 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1968 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1968
Postgres - Forward query executed 0 s.
- internalJg vertices:794, edges:22911
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3230 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3230 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3230
Postgres - Forward query executed 0 s.
- internalJg vertices:657, edges:22871
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1754 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1754 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1754
Postgres - Forward query executed 0 s.
- internalJg vertices:600, edges:22711
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3236 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3236 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3236
Postgres - Forward query executed 0 s.
- internalJg vertices:657, edges:22855
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3168 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3168 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3168
Postgres - Forward query executed 0 s.
- internalJg vertices:601, edges:22663
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5028 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5028 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5028
Postgres - Forward query executed 0 s.
- internalJg vertices:195, edges:3304
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3167 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3167 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3167
Postgres - Forward query executed 0 s.
- internalJg vertices:604, edges:22663
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5175 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5175 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5175
Postgres - Forward query executed 0 s.
- internalJg vertices:68, edges:3034
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1923 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1923 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1923
Postgres - Forward query executed 0 s.
- internalJg vertices:812, edges:23627
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=4491 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=4491 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=4491
Postgres - Forward query executed 0 s.
- internalJg vertices:351, edges:4296
createIntersectJg-jg1: 314 vertices and 1962 edges. jg2(union forward graphs generated by entry nodes): 856 vertices and 24028 edges.
jgIntersect has: 201 vertices and 536 edges.
finaljg has: 244 vertices and 637 edges.
Executed in 73 seconds.
