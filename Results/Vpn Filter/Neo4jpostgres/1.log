registerShutdownHook...
select nt.id as nodeid, et.* from Network nt join NetworkEvent et on nt.id=et.dstid where nt.srcip='192.168.1.131/32' and  nt.dstip='192.168.1.128/32' and  nt.hostid='1' and et.id='29704'
startNode: 664 edgeTime:1724732319377872104Mixed - backward executed in 1 s.
jg generated by the first clause has: 167 vertices and 6399 edges.
after CPR: 167 vertices and 494 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 2288 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 400(File) signature: 400: /root/.ssh/id_rsa.pub reputation: 0.290416693603447
 @@@@@ Top 2: id: 664(Network) signature: 664: 192.168.1.131/32:33110->192.168.1.128/32:22 reputation: 1.0
 @@@@@ Top 3: id: 398(File) signature: 398: /etc/services reputation: 0.290406158724264
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=400
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:35, edges:5374
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=664 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=664 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=664
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:1, edges:0
- jg vertices:35, edges:5374; internalJg vertices:1, edges:0

+ jg vertices:35, edges:5374

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=398
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:35, edges:5374
- jg vertices:35, edges:5374; internalJg vertices:35, edges:5374

+ jg vertices:36, edges:5381

createIntersectJg-jg1: 167 vertices and 494 edges. jg2(union forward graphs generated by entry nodes): 36 vertices and 5381 edges.
jgIntersect has: 33 vertices and 84 edges.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/home/fs1/malicious.sh",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 3 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732531452003131) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/home/fs1/malicious.sh' and  nt.hostid='2' and et.optype='write'
startNode: 6382 edgeTime:1724732531452003131Mixed - backward executed in 2 s.
jg generated by the first clause has: 1268 vertices and 15370 edges.
after CPR: 1268 vertices and 7165 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 2044 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 6157(File) signature: 6157: /lib/terminfo/x/xterm-256color reputation: 0.6593326819022789
 @@@@@ Top 2: id: 6381(Network) signature: 6381: 192.168.1.127/32:52242->192.168.1.128/32:12345 reputation: 0.9558840102025676
 @@@@@ Top 3: id: 2918(File) signature: 2918: /etc/bash.bashrc reputation: 0.6593326819022789
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=6157 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=6157 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=6157
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:9, edges:73
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=6381 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=6381 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=6381
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:6, edges:66
- jg vertices:9, edges:73; internalJg vertices:6, edges:66

+ jg vertices:10, edges:74

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2918 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2918 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2918
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:128, edges:20047
- jg vertices:10, edges:74; internalJg vertices:128, edges:20047

+ jg vertices:130, edges:20050

createIntersectJg-jg1: 1268 vertices and 7165 edges. jg2(union forward graphs generated by entry nodes): 130 vertices and 20050 edges.
jgIntersect has: 24 vertices and 54 edges.
** ProGQL graphs executed in 5 seconds.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/tmp/vpnfilter",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 3 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732372001719913) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/tmp/vpnfilter' and  nt.hostid='2' and et.optype='write'
startNode: 5315 edgeTime:1724732373470948490Mixed - backward executed in 0 s.
jg generated by the first clause has: 314 vertices and 22151 edges.
after CPR: 314 vertices and 1962 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 1976 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 3226(File) signature: 3226: /etc/wgetrc reputation: 0.6407234043890461
 @@@@@ Top 2: id: 5314(Network) signature: 5314: 192.168.1.128/32:53534->192.168.1.123/32:9001 reputation: 0.8352316704658719
 @@@@@ Top 3: id: 1968(File) signature: 1968: /etc/localtime reputation: 0.4704592924079666
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3226 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3226 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3226
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:600, edges:20495
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5314 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5314 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5314
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:7, edges:811
- jg vertices:600, edges:20495; internalJg vertices:7, edges:811

+ jg vertices:600, edges:20495

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1968 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1968 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1968
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:747, edges:20943
- jg vertices:600, edges:20495; internalJg vertices:747, edges:20943

+ jg vertices:777, edges:21326

createIntersectJg-jg1: 314 vertices and 1962 edges. jg2(union forward graphs generated by entry nodes): 777 vertices and 21326 edges.
jgIntersect has: 191 vertices and 444 edges.
** ProGQL graphs executed in 2 seconds.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/var/stage2",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 3 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732375008456085) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/var/stage2' and  nt.hostid='2' and et.optype='write'
startNode: 5616 edgeTime:1724732375032502907Mixed - backward executed in 0 s.
jg generated by the first clause has: 678 vertices and 22385 edges.
after CPR: 678 vertices and 2441 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 2403 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 5331(File) signature: 5331: /etc/ssl/certs/ca-certificates.crt reputation: 0.4416505321530825
 @@@@@ Top 2: id: 5325(Network) signature: 5325: 127.0.0.1/32:35353->127.0.0.53/32:53 reputation: 0.4416505321530825
 @@@@@ Top 3: id: 5332(File) signature: 5332: /etc/ssl/certs/002c0b4f.0 reputation: 0.4416505321530825
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5331 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5331 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5331
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:13, edges:1173
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5325 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5325 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5325
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:13, edges:1174
- jg vertices:13, edges:1173; internalJg vertices:13, edges:1174

+ jg vertices:14, edges:1178

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=5332 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=5332 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=5332
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:13, edges:1171
- jg vertices:14, edges:1178; internalJg vertices:13, edges:1171

+ jg vertices:15, edges:1180

createIntersectJg-jg1: 678 vertices and 2441 edges. jg2(union forward graphs generated by entry nodes): 15 vertices and 1180 edges.
jgIntersect has: 15 vertices and 24 edges.
** ProGQL graphs executed in 1 seconds.
++ Union multi ProGQL graphs executed in 9 seconds.
finaljg has: 246 vertices and 582 edges.
Executed in 20 seconds.
