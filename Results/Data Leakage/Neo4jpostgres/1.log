registerShutdownHook...
select nt.id as nodeid, et.* from Network nt join NetworkEvent et on nt.id=et.dstid where nt.srcip='192.168.1.131/32' and  nt.dstip='192.168.1.128/32' and  nt.hostid='1' and et.id='19396'
startNode: 577 edgeTime:1724731988353526987Mixed - backward executed in 1 s.
jg generated by the first clause has: 157 vertices and 5717 edges.
after CPR: 157 vertices and 384 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 980 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 399(File) signature: 399: /root/.ssh/id_rsa reputation: 0.7791800462325498
 @@@@@ Top 2: id: 577(Network) signature: 577: 192.168.1.131/32:59366->192.168.1.128/32:22 reputation: 1.0
 @@@@@ Top 3: id: 400(File) signature: 400: /root/.ssh/id_rsa.pub reputation: 0.7737520890258103
 @@@@@ Top 4: id: 569(Network) signature: 569: 192.168.1.131/32:59844->192.168.1.123/32:9001 reputation: 0.700391269808849
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=399
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:25, edges:4860
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=577 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=577 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=577
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:1, edges:0
- jg vertices:25, edges:4860; internalJg vertices:1, edges:0

+ jg vertices:25, edges:4860

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=400
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:25, edges:4851
- jg vertices:25, edges:4860; internalJg vertices:25, edges:4851

+ jg vertices:26, edges:4864

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=569 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=569 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=569
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:9, edges:119
- jg vertices:26, edges:4864; internalJg vertices:9, edges:119

+ jg vertices:26, edges:4864

createIntersectJg-jg1: 157 vertices and 384 edges. jg2(union forward graphs generated by entry nodes): 26 vertices and 4864 edges.
jgIntersect has: 23 vertices and 51 edges.
#####MATCH (p:Process)-[st:FileEvent{optype:"write"}]->(f:File{name:"/tmp/leaked.tar.bz2",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 6 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724732088896904555) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/tmp/leaked.tar.bz2' and  nt.hostid='2' and et.optype='write'
startNode: 4411 edgeTime:1724732088896911090Mixed - backward executed in 2 s.
jg generated by the first clause has: 256 vertices and 18460 edges.
after CPR: 256 vertices and 1292 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 2337 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 4399(File) signature: 4399: /root/.profile reputation: 0.8358104861573855
 @@@@@ Top 2: id: 3230(Network) signature: 3230: 192.168.1.128/32:48216->162.125.3.18/32:443 reputation: 0.3751899942320763
 @@@@@ Top 3: id: 4407(File) signature: 4407: /root/.bash_history reputation: 0.8358104861573855
 @@@@@ Top 4: id: 3236(Network) signature: 3236: 192.168.1.128/32:42050->162.125.3.15/32:443 reputation: 0.3751899942320763
 @@@@@ Top 5: id: 3255(File) signature: 3255: /root/.gnupg/pubring.kbx reputation: 0.501371021367067
 @@@@@ Top 6: id: 4111(Network) signature: 4111: 192.168.1.131/32:36314->192.168.1.128/32:22 reputation: 0.31924692665011983
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=4399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=4399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=4399
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:9, edges:56
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3230 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3230 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3230
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:412, edges:18367
- jg vertices:9, edges:56; internalJg vertices:412, edges:18367

+ jg vertices:413, edges:18369

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=4407 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=4407 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=4407
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:9, edges:55
- jg vertices:413, edges:18369; internalJg vertices:9, edges:55

+ jg vertices:414, edges:18370

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3236 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3236 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3236
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:412, edges:18351
- jg vertices:414, edges:18370; internalJg vertices:412, edges:18351

+ jg vertices:414, edges:18370

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3255 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3255 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3255
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:365, edges:8666
- jg vertices:414, edges:18370; internalJg vertices:365, edges:8666

+ jg vertices:415, edges:18375

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=4111 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=4111 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=4111
Mixed - Forward sql query executed 0 s.
Mixed - Forward graphDb.findNode executed 0 s.
- internalJg vertices:161, edges:360
- jg vertices:415, edges:18375; internalJg vertices:161, edges:360

+ jg vertices:422, edges:18390

createIntersectJg-jg1: 256 vertices and 1292 edges. jg2(union forward graphs generated by entry nodes): 422 vertices and 18390 edges.
jgIntersect has: 104 vertices and 230 edges.
** ProGQL graphs executed in 5 seconds.
++ Union multi ProGQL graphs executed in 5 seconds.
finaljg has: 127 vertices and 281 edges.
Executed in 16 seconds.
