select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/tmp/passwords.tar.bz2' and  nt.hostid='1' and et.id='15035'
startNode: 526 edgeTime:1724731846719889370Postgres - backward executed in 1 s.
jg generated by the first clause has: 154 vertices and 3117 edges.
after CPR: 154 vertices and 332 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 1400 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 250(File) signature: 250: /etc/group reputation: 0.8131986788550921
 @@@@@ Top 2: id: 513(Network) signature: 513: 192.168.1.131/32:51174->192.168.1.128/32:22 reputation: 0.7215976349755637
 @@@@@ Top 3: id: 386(File) signature: 386: /root/.ssh/config reputation: 0.7111809154831257
 @@@@@ Top 4: id: 389(Network) signature: 389: 192.168.1.131/32:34156->192.168.1.123/32:9001 reputation: 0.711920758762717
 @@@@@ Top 5: id: 402(File) signature: 402: /root/.ssh/known_hosts reputation: 0.6901873711208868
 @@@@@ Top 6: id: 405(Network) signature: 405: 192.168.1.131/32:41260->192.168.1.128/32:22 reputation: 0.6761961322500472
 @@@@@ Top 7: id: 399(File) signature: 399: /root/.ssh/id_rsa reputation: 0.6901256982264683
 @@@@@ Top 8: id: 362(Network) signature: 362: 192.168.1.131/32:37562->192.168.1.123/32:9001 reputation: 0.654741711624346
 @@@@@ Top 9: id: 400(File) signature: 400: /root/.ssh/id_rsa.pub reputation: 0.6900730820214518
 @@@@@ Top 10: id: 401(Network) signature: 401: 192.168.1.131/32:41252->192.168.1.128/32:22 reputation: 0.6537659650178431
 @@@@@ Top 11: id: 398(File) signature: 398: /etc/services reputation: 0.6900709607919675
 @@@@@ Top 12: id: 210(Network) signature: 210: 192.168.1.131/32:35098->192.168.1.123/32:9999 reputation: 0.47016870897879715
 @@@@@ Top 13: id: 397(File) signature: 397: /etc/ssh/ssh_config reputation: 0.6900707761622421
 @@@@@ Top 14: id: 361(File) signature: 361: /etc/wgetrc reputation: 0.6799818458456647
 @@@@@ Top 15: id: 241(File) signature: 241: /etc/localtime reputation: 0.6734204159615311
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=250 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=250 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=250
Postgres - Forward query executed 0 s.
- internalJg vertices:20, edges:123
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=513 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=513 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=513
Postgres - Forward query executed 0 s.
- internalJg vertices:10, edges:84
- jg vertices:20, edges:123; internalJg vertices:10, edges:84

+ jg vertices:24, edges:199

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=386 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=386 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=386
Postgres - Forward query executed 0 s.
- internalJg vertices:20, edges:4764
- jg vertices:24, edges:199; internalJg vertices:20, edges:4764

+ jg vertices:34, edges:4879

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=389 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=389 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=389
Postgres - Forward query executed 0 s.
- internalJg vertices:18, edges:4749
- jg vertices:34, edges:4879; internalJg vertices:18, edges:4749

+ jg vertices:34, edges:4879

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=402 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=402 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=402
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4569
- jg vertices:34, edges:4879; internalJg vertices:16, edges:4569

+ jg vertices:35, edges:4897

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=405 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=405 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=405
Postgres - Forward query executed 0 s.
- internalJg vertices:12, edges:4603
- jg vertices:35, edges:4897; internalJg vertices:12, edges:4603

+ jg vertices:35, edges:4897

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=399
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4689
- jg vertices:35, edges:4897; internalJg vertices:16, edges:4689

+ jg vertices:36, edges:4909

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=362 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=362 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=362
Postgres - Forward query executed 0 s.
- internalJg vertices:25, edges:4884
- jg vertices:36, edges:4909; internalJg vertices:25, edges:4884

+ jg vertices:36, edges:4958

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=400
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4680
- jg vertices:36, edges:4958; internalJg vertices:16, edges:4680

+ jg vertices:37, edges:4961

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=401 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=401 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=401
Postgres - Forward query executed 0 s.
- internalJg vertices:15, edges:4676
- jg vertices:37, edges:4961; internalJg vertices:15, edges:4676

+ jg vertices:37, edges:4961

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=398
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4680
- jg vertices:37, edges:4961; internalJg vertices:16, edges:4680

+ jg vertices:38, edges:4964

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=210 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=210 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=210
Postgres - Forward query executed 0 s.
- internalJg vertices:31, edges:4971
- jg vertices:38, edges:4964; internalJg vertices:31, edges:4971

+ jg vertices:39, edges:5038

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=397
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4683
- jg vertices:39, edges:5038; internalJg vertices:16, edges:4683

+ jg vertices:40, edges:5044

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=361 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=361 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=361
Postgres - Forward query executed 0 s.
- internalJg vertices:26, edges:4895
- jg vertices:40, edges:5044; internalJg vertices:26, edges:4895

+ jg vertices:41, edges:5050

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=241 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=241 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=241
Postgres - Forward query executed 0 s.
- internalJg vertices:33, edges:4909
- jg vertices:41, edges:5050; internalJg vertices:33, edges:4909

+ jg vertices:42, edges:5058

createIntersectJg-jg1: 154 vertices and 332 edges. jg2(union forward graphs generated by entry nodes): 42 vertices and 5058 edges.
jgIntersect has: 39 vertices and 86 edges.
#####MATCH (p:Process)-[st:NetworkEvent{id:100005}]->(f:Network{srcip:"192.168.1.128/32",dstip:"192.168.1.131/32",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 15 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724731846712161377) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from Network nt join NetworkEvent et on nt.id=et.dstid where nt.srcip='192.168.1.128/32' and  nt.dstip='192.168.1.131/32' and  nt.hostid='2' and et.id='100005'
startNode: 3398 edgeTime:1724731846712161377Postgres - backward executed in 5 s.
jg generated by the first clause has: 192 vertices and 17232 edges.
after CPR: 192 vertices and 663 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
computeFinalWeights invoked!
Within-group scattering matrix sw:
After 688 times iteration, the reputation of each vertex is stable
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 2859(File) signature: 2859: /etc/default/locale reputation: 0.8860578482563717
 @@@@@ Top 2: id: 3398(Network) signature: 3398: 192.168.1.128/32:22->192.168.1.131/32:51174 reputation: 1.0
 @@@@@ Top 3: id: 2858(File) signature: 2858: /etc/security/pam_env.conf reputation: 0.8860578028132893
 @@@@@ Top 4: id: 3295(Network) signature: 3295: 192.168.1.131/32:51174->192.168.1.128/32:22 reputation: 0.915490007460069
 @@@@@ Top 5: id: 2438(File) signature: 2438: /etc/environment reputation: 0.8860577470630304
 @@@@@ Top 6: id: 1890(Network) signature: 1890: 192.168.1.131/32:41252->192.168.1.128/32:22 reputation: 0.8167003658920435
 @@@@@ Top 7: id: 2158(File) signature: 2158: /etc/security/limits.conf reputation: 0.8860573323251077
 @@@@@ Top 8: id: 2861(Network) signature: 2861: 192.168.1.128/32:22->192.168.1.131/32:41252 reputation: 0.8167003658920435
 @@@@@ Top 9: id: 1936(File) signature: 1936: /etc/pam.d/common-auth reputation: 0.8858733998950894
 @@@@@ Top 10: id: 2932(Network) signature: 2932: 192.168.1.131/32:41260->192.168.1.128/32:22 reputation: 0.7744700437439398
 @@@@@ Top 11: id: 1948(File) signature: 1948: /etc/pam.d/common-session reputation: 0.8858635648467409
 @@@@@ Top 12: id: 3159(Network) signature: 3159: 192.168.1.128/32:22->192.168.1.131/32:41260 reputation: 0.7744700437439398
 @@@@@ Top 13: id: 1956(File) signature: 1956: /etc/pam.d/common-password reputation: 0.8858490143258761
 @@@@@ Top 14: id: 3240(Network) signature: 3240: 192.168.1.128/32:43026->192.168.1.123/32:9001 reputation: 0.6886994859827744
 @@@@@ Top 15: id: 1963(File) signature: 1963: /etc/group reputation: 0.8856622609085243
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2859 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2859 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2859
Postgres - Forward query executed 0 s.
- internalJg vertices:173, edges:17244
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3398
Postgres - Forward query executed 0 s.
- internalJg vertices:42, edges:98
- jg vertices:173, edges:17244; internalJg vertices:42, edges:98

+ jg vertices:173, edges:17244

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2858 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2858 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2858
Postgres - Forward query executed 0 s.
- internalJg vertices:173, edges:17250
- jg vertices:173, edges:17244; internalJg vertices:173, edges:17250

+ jg vertices:174, edges:17256

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3295 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3295 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3295
Postgres - Forward query executed 0 s.
- internalJg vertices:46, edges:156
- jg vertices:174, edges:17256; internalJg vertices:46, edges:156

+ jg vertices:178, edges:17312

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2438 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2438 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2438
Postgres - Forward query executed 0 s.
- internalJg vertices:255, edges:17364
- jg vertices:178, edges:17312; internalJg vertices:255, edges:17364

+ jg vertices:261, edges:17438

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1890 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1890 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1890
Postgres - Forward query executed 0 s.
- internalJg vertices:307, edges:17587
- jg vertices:261, edges:17438; internalJg vertices:307, edges:17587

+ jg vertices:310, edges:17613

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2158 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2158 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2158
Postgres - Forward query executed 0 s.
- internalJg vertices:300, edges:17418
- jg vertices:310, edges:17613; internalJg vertices:300, edges:17418

+ jg vertices:311, edges:17621

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2861 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2861 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2861
Postgres - Forward query executed 0 s.
- internalJg vertices:178, edges:17352
- jg vertices:311, edges:17621; internalJg vertices:178, edges:17352

+ jg vertices:311, edges:17621

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1936 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1936 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1936
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:17440
- jg vertices:311, edges:17621; internalJg vertices:302, edges:17440

+ jg vertices:312, edges:17635

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2932 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2932 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2932
Postgres - Forward query executed 0 s.
- internalJg vertices:134, edges:17223
- jg vertices:312, edges:17635; internalJg vertices:134, edges:17223

+ jg vertices:312, edges:17635

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1948 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1948 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1948
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:17440
- jg vertices:312, edges:17635; internalJg vertices:302, edges:17440

+ jg vertices:313, edges:17649

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3159 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3159 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3159
Postgres - Forward query executed 0 s.
- internalJg vertices:132, edges:17163
- jg vertices:313, edges:17649; internalJg vertices:132, edges:17163

+ jg vertices:313, edges:17649

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1956 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1956 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1956
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:17440
- jg vertices:313, edges:17649; internalJg vertices:302, edges:17440

+ jg vertices:314, edges:17663

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3240 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3240 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3240
Postgres - Forward query executed 0 s.
- internalJg vertices:82, edges:16196
- jg vertices:314, edges:17663; internalJg vertices:82, edges:16196

+ jg vertices:314, edges:17663

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1963 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1963 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1963
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:22492
- jg vertices:314, edges:17663; internalJg vertices:302, edges:22492

+ jg vertices:319, edges:22739

createIntersectJg-jg1: 192 vertices and 663 edges. jg2(union forward graphs generated by entry nodes): 319 vertices and 22739 edges.
jgIntersect has: 85 vertices and 196 edges.
** ProGQL graphs executed in 58 seconds.
++ Union multi ProGQL graphs executed in 58 seconds.
finaljg has: 124 vertices and 282 edges.
Executed in 80 seconds.
