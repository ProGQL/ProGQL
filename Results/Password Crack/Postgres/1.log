select nt.id as nodeid, et.* from File nt join FileEvent et on nt.id=et.dstid where nt.name='/tmp/passwords.tar.bz2' and  nt.hostid='1' and et.optype='write'
startNode: 526 edgeTime:1724731846719889370Postgres - backward executed in 1 s.
jg generated by the first clause has: 154 vertices and 3117 edges.
after CPR: 154 vertices and 328 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
Within-group scattering matrix sw:
PageRankIteration called!!!!!!!!!!!!!!!!!!
PageRankIteration - After 1508 times iteration, the reputation of each vertex is stable
PageRankIteration execution time is: 0.137
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 386(File) signature: 386: /root/.ssh/config reputation: 0.7343616260255965
 @@@@@ Top 2: id: 513(Network) signature: 513: 192.168.1.131/32:51174->192.168.1.128/32:22 reputation: 0.7478207824467449
 @@@@@ Top 3: id: 250(File) signature: 250: /etc/group reputation: 0.7304031474583315
 @@@@@ Top 4: id: 405(Network) signature: 405: 192.168.1.131/32:41260->192.168.1.128/32:22 reputation: 0.7323764722380588
 @@@@@ Top 5: id: 402(File) signature: 402: /root/.ssh/known_hosts reputation: 0.7302116023322958
 @@@@@ Top 6: id: 389(Network) signature: 389: 192.168.1.131/32:34156->192.168.1.123/32:9001 reputation: 0.7100400540688048
 @@@@@ Top 7: id: 399(File) signature: 399: /root/.ssh/id_rsa reputation: 0.730140258117997
 @@@@@ Top 8: id: 401(Network) signature: 401: 192.168.1.131/32:41252->192.168.1.128/32:22 reputation: 0.7066298195397335
 @@@@@ Top 9: id: 400(File) signature: 400: /root/.ssh/id_rsa.pub reputation: 0.7300770918757489
 @@@@@ Top 10: id: 362(Network) signature: 362: 192.168.1.131/32:37562->192.168.1.123/32:9001 reputation: 0.5819190420911498
 @@@@@ Top 11: id: 398(File) signature: 398: /etc/services reputation: 0.730074230446293
 @@@@@ Top 12: id: 210(Network) signature: 210: 192.168.1.131/32:35098->192.168.1.123/32:9999 reputation: 0.44474481085241857
 @@@@@ Top 13: id: 397(File) signature: 397: /etc/ssh/ssh_config reputation: 0.7300739936291433
 @@@@@ Top 14: id: 361(File) signature: 361: /etc/wgetrc reputation: 0.6426014591709683
 @@@@@ Top 15: id: 113(File) signature: 113: /etc/nsswitch.conf reputation: 0.6236478325502733
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=386 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=386 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=386
Postgres - Forward query executed 0 s.
- internalJg vertices:20, edges:4764
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=513 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=513 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=513
Postgres - Forward query executed 0 s.
- internalJg vertices:10, edges:84
- jg vertices:20, edges:4764; internalJg vertices:10, edges:84

+ jg vertices:20, edges:4764

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=250 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=250 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=250
Postgres - Forward query executed 0 s.
- internalJg vertices:20, edges:123
- jg vertices:20, edges:4764; internalJg vertices:20, edges:123

+ jg vertices:34, edges:4879

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=405 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=405 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=405
Postgres - Forward query executed 0 s.
- internalJg vertices:12, edges:4603
- jg vertices:34, edges:4879; internalJg vertices:12, edges:4603

+ jg vertices:34, edges:4879

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=402 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=402 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=402
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4569
- jg vertices:34, edges:4879; internalJg vertices:16, edges:4569

+ jg vertices:35, edges:4897

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=389 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=389 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=389
Postgres - Forward query executed 0 s.
- internalJg vertices:18, edges:4749
- jg vertices:35, edges:4897; internalJg vertices:18, edges:4749

+ jg vertices:35, edges:4897

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=399 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=399
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4689
- jg vertices:35, edges:4897; internalJg vertices:16, edges:4689

+ jg vertices:36, edges:4909

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=401 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=401 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=401
Postgres - Forward query executed 0 s.
- internalJg vertices:15, edges:4676
- jg vertices:36, edges:4909; internalJg vertices:15, edges:4676

+ jg vertices:36, edges:4909

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=400 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=400
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4680
- jg vertices:36, edges:4909; internalJg vertices:16, edges:4680

+ jg vertices:37, edges:4912

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=362 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=362 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=362
Postgres - Forward query executed 0 s.
- internalJg vertices:25, edges:4884
- jg vertices:37, edges:4912; internalJg vertices:25, edges:4884

+ jg vertices:37, edges:4961

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=398
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4680
- jg vertices:37, edges:4961; internalJg vertices:16, edges:4680

+ jg vertices:38, edges:4964

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=210 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=210 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=210
Postgres - Forward query executed 0 s.
- internalJg vertices:31, edges:4971
- jg vertices:38, edges:4964; internalJg vertices:31, edges:4971

+ jg vertices:39, edges:5038

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=397 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=397
Postgres - Forward query executed 0 s.
- internalJg vertices:16, edges:4683
- jg vertices:39, edges:5038; internalJg vertices:16, edges:4683

+ jg vertices:40, edges:5044

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=361 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=361 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=361
Postgres - Forward query executed 0 s.
- internalJg vertices:26, edges:4895
- jg vertices:40, edges:5044; internalJg vertices:26, edges:4895

+ jg vertices:41, edges:5050

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=113 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=113 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=113
Postgres - Forward query executed 0 s.
- internalJg vertices:39, edges:5256
- jg vertices:41, edges:5050; internalJg vertices:39, edges:5256

+ jg vertices:51, edges:5413

createIntersectJg-jg1: 154 vertices and 328 edges. jg2(union forward graphs generated by entry nodes): 51 vertices and 5413 edges.
jgIntersect has: 44 vertices and 98 edges.
#####MATCH (p:Process)-[st:NetworkEvent{id:100005}]->(f:Network{srcip:"192.168.1.128/32",dstip:"192.168.1.131/32",hostid:"2"}) BFS (r IN backward (f) | MATCH v=dst(r) WHERE r.starttime<max(collect(vout IN out(v) | vout.endtime))) YIELD g1 UNWIND g1 AS e SET e.weight=PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v))) MATCH u=src(e) SET u.rel=REDUCE (sum=0 , o IN out(u) | sum+o.weight*dst(o).rel) RETURN g1 intersect WITH entry = MATCH n IN nodes(r) WHERE count(in(n))=0 ORDER BY n.rel DESC LIMIT 15 BFS (re IN forward (entry) | MATCH u=src(re) WHERE re.endtime>min(collect(uin IN in(u) | uin.starttime)) and re.starttime<1724731846712161377) YIELD g2 RETURN g2
select nt.id as nodeid, et.* from Network nt join NetworkEvent et on nt.id=et.dstid where nt.srcip='192.168.1.128/32' and  nt.dstip='192.168.1.131/32' and  nt.hostid='2' and et.id='100005'
startNode: 3398 edgeTime:1724731846712161377Postgres - backward executed in 5 s.
jg generated by the first clause has: 192 vertices and 17232 edges.
after CPR: 192 vertices and 656 edges.
PROJECTION (1/(abs(r.amount-st.amount)+0.0001), ln(1+1/abs(r.endtime-st.endtime)), count(out(v))/count(in(v)))
Within-group scattering matrix sw:
PageRankIteration called!!!!!!!!!!!!!!!!!!
PageRankIteration - After 500 times iteration, the reputation of each vertex is stable
PageRankIteration execution time is: 0.051
Expression: count(in(n))=0
Operator: =
Value: 0
 @@@@@ Top 1: id: 2859(File) signature: 2859: /etc/default/locale reputation: 0.9352888862366068
 @@@@@ Top 2: id: 3398(Network) signature: 3398: 192.168.1.128/32:22->192.168.1.131/32:51174 reputation: 1.0
 @@@@@ Top 3: id: 2858(File) signature: 2858: /etc/security/pam_env.conf reputation: 0.9352885464437576
 @@@@@ Top 4: id: 3295(Network) signature: 3295: 192.168.1.131/32:51174->192.168.1.128/32:22 reputation: 0.9493569225212987
 @@@@@ Top 5: id: 2438(File) signature: 2438: /etc/environment reputation: 0.9352881155969587
 @@@@@ Top 6: id: 1890(Network) signature: 1890: 192.168.1.131/32:41252->192.168.1.128/32:22 reputation: 0.8682978431708329
 @@@@@ Top 7: id: 2158(File) signature: 2158: /etc/security/limits.conf reputation: 0.9352849391604008
 @@@@@ Top 8: id: 2861(Network) signature: 2861: 192.168.1.128/32:22->192.168.1.131/32:41252 reputation: 0.8682978431708329
 @@@@@ Top 9: id: 2919(File) signature: 2919: /root/.bashrc reputation: 0.9335531169651653
 @@@@@ Top 10: id: 2932(Network) signature: 2932: 192.168.1.131/32:41260->192.168.1.128/32:22 reputation: 0.843640418287004
 @@@@@ Top 11: id: 2918(File) signature: 2918: /etc/bash.bashrc reputation: 0.9335363775978163
 @@@@@ Top 12: id: 3159(Network) signature: 3159: 192.168.1.128/32:22->192.168.1.131/32:41260 reputation: 0.843640418287004
 @@@@@ Top 13: id: 1965(File) signature: 1965: /root/.ssh/authorized_keys reputation: 0.9322627089423352
 @@@@@ Top 14: id: 3240(Network) signature: 3240: 192.168.1.128/32:43026->192.168.1.123/32:9001 reputation: 0.758850106661197
 @@@@@ Top 15: id: 1935(File) signature: 1935: /etc/pam.d/sshd reputation: 0.9317512951953789
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2859 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2859 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2859
Postgres - Forward query executed 0 s.
- internalJg vertices:173, edges:17244
Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3398 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3398
Postgres - Forward query executed 0 s.
- internalJg vertices:42, edges:98
- jg vertices:173, edges:17244; internalJg vertices:42, edges:98

+ jg vertices:173, edges:17244

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2858 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2858 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2858
Postgres - Forward query executed 0 s.
- internalJg vertices:173, edges:17250
- jg vertices:173, edges:17244; internalJg vertices:173, edges:17250

+ jg vertices:174, edges:17256

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3295 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3295 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3295
Postgres - Forward query executed 0 s.
- internalJg vertices:46, edges:156
- jg vertices:174, edges:17256; internalJg vertices:46, edges:156

+ jg vertices:178, edges:17312

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2438 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2438 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2438
Postgres - Forward query executed 0 s.
- internalJg vertices:255, edges:17364
- jg vertices:178, edges:17312; internalJg vertices:255, edges:17364

+ jg vertices:261, edges:17438

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1890 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1890 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1890
Postgres - Forward query executed 0 s.
- internalJg vertices:307, edges:17587
- jg vertices:261, edges:17438; internalJg vertices:307, edges:17587

+ jg vertices:310, edges:17613

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2158 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2158 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2158
Postgres - Forward query executed 0 s.
- internalJg vertices:300, edges:17418
- jg vertices:310, edges:17613; internalJg vertices:300, edges:17418

+ jg vertices:311, edges:17621

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2861 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2861 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2861
Postgres - Forward query executed 0 s.
- internalJg vertices:178, edges:17352
- jg vertices:311, edges:17621; internalJg vertices:178, edges:17352

+ jg vertices:311, edges:17621

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2919 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2919 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2919
Postgres - Forward query executed 0 s.
- internalJg vertices:62, edges:16966
- jg vertices:311, edges:17621; internalJg vertices:62, edges:16966

+ jg vertices:312, edges:17624

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2932 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2932 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2932
Postgres - Forward query executed 0 s.
- internalJg vertices:134, edges:17223
- jg vertices:312, edges:17624; internalJg vertices:134, edges:17223

+ jg vertices:312, edges:17624

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=2918 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=2918 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=2918
Postgres - Forward query executed 0 s.
- internalJg vertices:62, edges:16966
- jg vertices:312, edges:17624; internalJg vertices:62, edges:16966

+ jg vertices:313, edges:17627

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3159 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3159 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3159
Postgres - Forward query executed 0 s.
- internalJg vertices:132, edges:17163
- jg vertices:313, edges:17627; internalJg vertices:132, edges:17163

+ jg vertices:313, edges:17627

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1965 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1965 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1965
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:17438
- jg vertices:313, edges:17627; internalJg vertices:302, edges:17438

+ jg vertices:314, edges:17639

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=3240 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=3240 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=3240
Postgres - Forward query executed 0 s.
- internalJg vertices:82, edges:16196
- jg vertices:314, edges:17639; internalJg vertices:82, edges:16196

+ jg vertices:314, edges:17639

Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, 0 as amount From processevent Where srcid=1935 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From networkevent Where srcid=1935 union Select id as eventid, srcid as parentid, starttime, endtime, optype, hostname, amount From fileevent Where srcid=1935
Postgres - Forward query executed 0 s.
- internalJg vertices:302, edges:17432
- jg vertices:314, edges:17639; internalJg vertices:302, edges:17432

+ jg vertices:315, edges:17645

createIntersectJg-jg1: 192 vertices and 656 edges. jg2(union forward graphs generated by entry nodes): 315 vertices and 17645 edges.
jgIntersect has: 85 vertices and 187 edges.
** ProGQL graphs executed in 58 seconds.
++ Union multi ProGQL graphs executed in 58 seconds.
finaljg has: 129 vertices and 285 edges.
Executed in 79 seconds.
